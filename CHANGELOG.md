# Changelog

## Форматы артефактов в релизах

| Файл | Формат | Для чего |
|------|--------|----------|
| `awg-proxy-{arch}.tar.gz` | OCI | RouterOS 7.x (стандартный формат) |
| `awg-proxy-{arch}-7.20-Docker.tar.gz` | Classic Docker | RouterOS 7.20 LT (legacy формат) |
| `awg-proxy-linux-{arch}` | Бинарник | Запуск без Docker (Linux) |

> Если вы не знаете какой формат выбрать — используйте **OCI** (`awg-proxy-{arch}.tar.gz`).
> Формат **7.20-Docker** нужен только для RouterOS версии 7.20 LT.

---

## v0.1.18 (2026-02-26)

- Обновление README

## v0.1.17 (2026-02-25)

- Ускорение сборки Docker-образов
- Добавлено видео спидтеста

## v0.1.16 (2026-02-25)

- Исправлен баг с таймаутом переподключения
- Обновление документации

## v0.1.15 (2026-02-25)

- Поддержка пользовательского диска в конфигураторе (usb1, usb2, sd1, nvme1, sata1, custom)
- Добавлена архитектура arm/v5
- Оптимизация кода для высокой нагрузки:
  - Batch I/O через `recvmmsg`/`sendmmsg` на Linux (несколько пакетов за один syscall)
  - Zero-alloc генерация junk-пакетов (предвыделенные буферы)
  - Увеличены буферы сокетов до 16 MB (настраивается через `AWG_SOCKET_BUF`)
  - Привязка I/O-горутин к потокам ОС (`runtime.LockOSThread`)
- Изменение именования Docker-образов для 7.20, обновление документации

## v0.1.14 (2026-02-25)

- Обновление уведомлений конфигуратора

## v0.1.13 (2026-02-25)

- Исправление сборщика

## v0.1.12 (2026-02-25)

- Оптимизации Go:
  - Замена `sync.Pool` на горутин-локальные буферы (меньше накладных расходов)
  - Таймаут активности через `atomic.Bool` вместо `time.Now().Unix()` (без аллокаций)
  - Выделенная горутина для проверки таймаутов
  - Блокирующие чтения вместо цикла с `SetReadDeadline`

## v0.1.11 (2026-02-25)

- Добавлены бинарные сборки (без Docker)

## v0.1.10 (2026-02-24)

- Оптимизация runtime overhead:
  - `GOMAXPROCS=2` по умолчанию (настраивается через `AWG_GOMAXPROCS`)
  - Привязка I/O-горутин к потокам ОС
  - Atomic-флаг остановки вместо `select` по каналу
- Версия сборки в логе

## v0.1.9 (2026-02-24)

- Масштабная оптимизация производительности Go:
  - `netip.AddrPort` вместо `*net.UDPAddr` (value type, без аллокаций при сравнении)
  - Атомарный указатель на remote-соединение (lock-free доступ из обеих горутин)
  - Буферы сокетов 2 MB, guard-проверки уровня логирования
- Обновление README

## v0.1.8 (2026-02-24)

- Исправлена ссылка на помощь (PR #5 от @burnedoutman)

## v0.1.7 (2026-02-24)

- Поддержка AmneziaWG v1.5
- Добавлен пользовательский диск в конфигуратор
- Добавлена поддержка RouterOS 7.20 LT (классический формат Docker-образов)

## v0.1.6 (2026-02-24)

- Поддержка AmneziaWG v1.5 и v2
